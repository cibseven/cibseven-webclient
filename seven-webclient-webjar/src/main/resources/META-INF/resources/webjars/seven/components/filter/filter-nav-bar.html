<div v-show="showFilters" class="overflow-auto h-100">
	<div class="h-100 d-flex flex-column">
		
		<filter-modal ref="filterModal" @select-filter="selectFilter($event)" @display-popover="$emit('display-popover', $event)" @filter-alert="$emit('filter-alert', $event)" @set-filter="$emit('set-filter', $event)"></filter-modal>
		
		<div v-if="$root.config.filtersSearch" class="p-2" style="background-color: rgb(98, 142, 199, 0.3)">
			<b-input-group>
				<template v-slot:prepend>
					<b-input-group-text class="py-0 border-light"><span class="mdi mdi-18px mdi-magnify"
					style="line-height: initial"></span></b-input-group-text>
				</template>
				<b-form-input :title="$t('searches.searchByFilterName')" size="sm" ref="input" type="search" v-model="filter"
				class="form-control border-start-0 ps-0 form-control border-light shadow-none" :placeholder="$t('searches.searchByFilterName')"/>
				<template #append>
					<b-button size="sm" v-hover-style="{ classes: ['text-primary'] }" variant="secondary-outline" 
						@click="sortOrder === 'desc' ? sortOrder = 'asc' : sortOrder = 'desc'" class="mdi mdi-16px py-0" 
						:class="sortOrder === 'desc' ? 'mdi-arrow-down' : 'mdi-arrow-up'" 
						:title="sortOrder === 'desc' ? $t('sorting.desc') : $t('sorting.asc')">
						<span v-if="sortOrder === 'desc'" class="visually-hidden">{{ $t('sorting.desc') }}</span>
						<span v-else class="visually-hidden">{{ $t('sorting.asc') }}</span>
					</b-button>
				</template>
			</b-input-group>
		</div>
		<div v-if="filtersFiltered.length > 0" class="overflow-auto flex-fill">
			<b-list-group>
				<b-list-group-item v-for="filter of filtersFiltered" :key="filter.id" @mouseenter="focused = filter" @mouseleave="focused = null" 
					action class="border-0 rounded-0 p-2" :class="filter.id === $store.state.filter.selected.id ? 'active' : ''" :to="'/flow/auth/tasks/' + filter.id">
					<div class="d-flex align-items-center">							
						<div class="col-7 p-0" style="word-wrap: break-word">
							<span>{{ filter.name }} <b-badge v-if="filter.tasksNumber" pill variant="light">{{ filter.tasksNumber }}</b-badge></span>
						</div>
						<div :class="getClasses(filter)" class="ms-auto">
							<button v-if="filterByPermissions($root.config.permissions.editFilter, $store.state.filter.selected)" 
								class="btn btn-outline-secondary btn-sm border-0" type="button" :title="$t('nav-bar.filters.edit')" @click.prevent="selectFilter(filter); showFilterDialog('edit')">
								<span class="visually-hidden">{{ $t('nav-bar.filters.edit') }}</span>
								<span class="mdi mdi-pencil"></span>
							</button>
							<button v-if="filterByPermissions($root.config.permissions.deleteFilter, $store.state.filter.selected)" 
								class="btn btn-outline-secondary btn-sm border-0" type="button" :title="$t('nav-bar.filters.delete')"
								@click.prevent="selectFilter(filter); $refs.confirmDeleteFilter.show()">
								<span class="visually-hidden">{{ $t('nav-bar.filters.delete') }}</span>
								<span class="mdi mdi-close"></span>
							</button>
						</div>								
						<button v-if="filter.favorite" class="btn btn-outline-secondary btn-sm border-0" type="button"
							@click.prevent="deleteFavoriteFilter(filter)" :title="$t('nav-bar.filters.pin')">
							<span class="visually-hidden">{{ $t('av-bar.filters.pin') }}</span>
							<span class="mdi mdi-pin text-dark"></span>
						</button>
						<button v-else class="btn btn-outline-secondary btn-sm border-0" type="button"
							@click.prevent="setFavoriteFilter(filter)" :title="$t('nav-bar.filters.pin')">
							<span class="visually-hidden">{{ $t('nav-bar.filters.pin') }}</span>
							<span class="mdi mdi-pin text-muted"></span>
						</button>
					</div>
				</b-list-group-item>				
			</b-list-group>
		</div>
		<loader ref="filterLoader" class="d-flex flex-fill justify-content-center pt-4" styling="width:30%">
			<div v-if="filtersFiltered.length < 1">
				<img src="webjars/seven/components/task/no_tasks.svg" class="d-block mx-auto mt-3 mb-2" style="width: 200px">
				<div class="h5 text-secondary text-center">{{ $t('nav-bar.filters.no-filters') }}</div>
			</div>
		</loader>
		<button v-if="filterByPermissions($root.config.permissions.createFilter, null, true)" 
			class="btn btn-outline-secondary btn-sm border-light p-2" type="button"
			@click="showFilterDialog('create')">
			<span>{{ $t('nav-bar.filters.create') }}</span><span class="mdi mdi-plus"></span>
		</button>
	</div>
	<confirm ref="confirmDeleteFilter" @ok="deleteFilter()">
		<span v-html="$t('confirm.deleteFilter', [$store.state.filter.selected.name])"></span>
	</confirm>	
</div>
