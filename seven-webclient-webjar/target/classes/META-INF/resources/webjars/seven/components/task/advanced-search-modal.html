<b-modal ref="advancedSearchModal" :title="$t('advanced-search.title')" @hidden="onModalHidden" size="lg">
	<form ref="formAdvancedSearch" @submit.stop.prevent="handleSubmit">
		<div class="row mb-3">
			<div class="col-5">
				<label>{{ $t('advanced-search.criteriaKey') }}</label>
				<b-form-select v-model="selectedCriteriaKey" :options="criteriaKeys">
					<template v-slot:first>
						<b-form-select-option :value="null" disabled>-- {{ $t('advanced-search.selectProperty') }} --</b-form-select-option>
					</template>
				</b-form-select>
			</div>
		</div>
		<div class="row mb-3">
			<div class="col-5">
				<b-form-input :placeholder="$t('advanced-search.property')" v-model="selectedCriteriaValue.name"></b-form-input>
			</div>
			<div class="col-2">
				<b-form-select v-model="selectedCriteriaValue.operator" :options="operators"></b-form-select>
			</div>
			<div class="col-5">
				<b-form-input :placeholder="$t('advanced-search.value')" v-model="selectedCriteriaValue.value"></b-form-input>
			</div>		
		</div>
		<b-button @click="addCriteria" :title="$t('advanced-search.add')" variant="primary" class="mb-3">
	  		<span class="d-inline-block align-middle mdi mdi-16px mdi-plus" style="line-height: 0"></span> {{ $t('advanced-search.add') }}
	  	</b-button>
	  	
	  	<div class="container-fluid border">	  	
		  	<flow-table striped :selectable="false" :items="criterias" prefix="advanced-search.table."
				:fields="[{label: 'key', key: 'key', class: 'col-5'},
						{label: 'value', key: 'value', class: 'col-5'},
						{label: '', key: 'buttons', class: 'col-2', sortable: false, tdClass: 'py-0 text-center d-block'}]">
				<template v-slot:cell(key)="row">
					{{ $t('advanced-search.criteriaKeys.' + row.item.key) }}		
				</template> 
				<template v-slot:cell(value)="row">
					<div class="col-12" v-if="row.item.key === 'processVariables'">
						<div class="row">
							<div :title="row.item.name" class="col-5 p-0 text-truncate">{{ row.item.name }}</div>
							<div class="col-2 text-center">{{ $t('advanced-search.operators.' + row.item.operator) }}</div>
							<div :title="row.item.value" class="col-5 p-0 text-truncate text-end">{{ row.item.value }}</div>
						</div>
					</div>
					<span v-else> {{ row.item.value }} </span>
				</template> 
				<template v-slot:cell(buttons)="row" class="text-center">
					<b-button class="p-0 px-2 border-0 mdi mdi-24px mdi-delete-outline shadow-none" variant="link" @click="deleteCriteria(row.index)"></b-button>
				</template>
			</flow-table>
			
			<div v-if="criterias.length === 0">
				<img src="webjars/seven/components/task/no_tasks_pending.svg" class="d-block mx-auto mb-3" style="width: 200px">		
				<div class="h5 text-secondary text-center">{{ $t('nav-bar.filters.noCriterias') }}</div>
			</div>
			<hr>
			<b-form-checkbox class="mb-3" v-model="matchAllCriteria" name="check-button" switch>
				<span>{{ $t('nav-bar.filters.matchAllCriteria') }}</span>
			</b-form-checkbox>
		</div>
		
	</form>
	<template #modal-footer>
        <b-button variant="primary" @click="handleSubmit" :title="$t('advanced-search.apply')">{{ $t('advanced-search.apply') }}</b-button>
        <b-button variant="link" @click="$refs.advancedSearchModal.hide()" :title="$t('advanced-search.cancel')">{{ $t('advanced-search.cancel') }}</b-button>
    </template>
</b-modal>
